(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5479:function(e,t,a){Promise.resolve().then(a.bind(a,6751))},6751:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var s=a(7437),i=a(2265),l=a(7318),n=a(4033);function ProtectedRoute(e){let{children:t}=e,{user:a,loading:d}=(0,l.useAuth)(),r=(0,n.useRouter)();return((0,i.useEffect)(()=>{d||a||r.push("/login")},[a,d,r]),d)?(0,s.jsx)("div",{className:"loading-screen",children:(0,s.jsxs)("div",{className:"loading-spinner",children:[(0,s.jsx)("i",{className:"ri-loader-4-line"}),(0,s.jsx)("span",{children:"Loading..."})]})}):a?(0,s.jsx)(s.Fragment,{children:t}):null}var d=a(2445);function NotesApp(){let{user:e,signOut:t}=(0,l.useAuth)(),a=(0,n.useRouter)(),[r,c]=(0,i.useState)(!0),[o,m]=(0,i.useState)(""),[h,u]=(0,i.useState)("all"),[N,x]=(0,i.useState)([]),[g,j]=(0,i.useState)(""),[p,v]=(0,i.useState)(!1),[f,b]=(0,i.useState)(null),[C,w]=(0,i.useState)(!1),[y,S]=(0,i.useState)(!1),[_,k]=(0,i.useState)(""),[D,A]=(0,i.useState)(""),[P,O]=(0,i.useState)(""),[T,E]=(0,i.useState)([]),[F,L]=(0,i.useState)([]),[U,q]=(0,i.useState)([]);(0,i.useEffect)(()=>{if(!e)return;let fetchNotes=async()=>{let{data:t,error:a}=await d.O.from("notes").select("*").eq("user_id",e.id).order("updated_at",{ascending:!1});!a&&t&&E(t)},fetchFolders=async()=>{let{data:t,error:a}=await d.O.from("folders").select("*").eq("user_id",e.id).order("created_at",{ascending:!0});!a&&t&&L(t)},fetchTags=async()=>{let{data:t,error:a}=await d.O.from("tags").select("*").eq("user_id",e.id).order("created_at",{ascending:!0});!a&&t&&q(t)};fetchNotes(),fetchFolders(),fetchTags(),c(!0),document.documentElement.setAttribute("data-theme","dark")},[e]);let handleNewNote=async()=>{if(!e)return;let t={user_id:e.id,title:"",content:"",folder:"all"===h?"personal":h,tags:[],is_pinned:!1,is_private:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:a,error:s}=await d.O.from("notes").insert([t]).select();!s&&a&&a[0]&&(E(e=>[a[0],...e]),j(a[0].id),b(a[0]),v(!0))},handleSaveNote=async()=>{if(!f||!e)return;let t={...f,updated_at:new Date().toISOString()},{data:a,error:s}=await d.O.from("notes").update(t).eq("id",t.id).eq("user_id",e.id).select();!s&&a&&a[0]&&(E(e=>e.map(e=>e.id===t.id?a[0]:e)),v(!1))},handleDeleteNote=async t=>{if(!e)return;let{error:a}=await d.O.from("notes").delete().eq("id",t).eq("user_id",e.id);a||(E(e=>e.filter(e=>e.id!==t)),g===t&&(j(""),b(null)))},handleTogglePin=async t=>{if(!e)return;let a=T.find(e=>e.id===t);if(!a)return;let{data:s,error:i}=await d.O.from("notes").update({is_pinned:!a.is_pinned,updated_at:new Date().toISOString()}).eq("id",t).eq("user_id",e.id).select();!i&&s&&s[0]&&E(e=>e.map(e=>e.id===t?s[0]:e))},handleNoteSelect=e=>{let t=T.find(t=>t.id===e);t&&(j(e),b(t),v(!1))},handleCreateFolder=async()=>{if(!_.trim()){O("Folder name cannot be empty");return}if(!e)return;let t=F.some(e=>e.name.toLowerCase()===_.trim().toLowerCase());if(t){O("A folder with this name already exists");return}let{data:a,error:s}=await d.O.from("folders").insert([{user_id:e.id,name:_.trim()}]).select();!s&&a&&a[0]?(L(e=>[...e,a[0]]),k(""),O(""),w(!1)):(console.error("Folder creation error:",s),O((null==s?void 0:s.message)||"Failed to create folder"))},handleCreateTag=async()=>{if(!D.trim()){O("Tag name cannot be empty");return}if(!e)return;let t=U.some(e=>e.name.toLowerCase()===D.trim().toLowerCase());if(t){O("A tag with this name already exists");return}let{data:a,error:s}=await d.O.from("tags").insert([{user_id:e.id,name:D.trim()}]).select();!s&&a&&a[0]?(q(e=>[...e,a[0]]),A(""),O(""),S(!1)):(console.error("Tag creation error:",s),O((null==s?void 0:s.message)||"Failed to create tag"))},handleDeleteFolder=e=>{E(t=>t.map(t=>t.folder===e?{...t,folder:"personal"}:t)),L(t=>t.filter(t=>t.id!==e)),h===e&&u("all")},handleTagSelect=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},handleDeleteTag=e=>{E(t=>t.map(t=>({...t,tags:t.tags.filter(t=>t!==e)}))),q(t=>t.filter(t=>t.id!==e)),x(t=>t.filter(t=>t!==e))},I=T.filter(e=>!!(("all"===h||e.folder===h)&&(!(N.length>0)||N.every(t=>e.tags.includes(t)))&&(!o||e.title.toLowerCase().includes(o.toLowerCase())||e.content.toLowerCase().includes(o.toLowerCase())))),H=I.filter(e=>e.is_pinned),R=I.filter(e=>!e.is_pinned),formatDate=e=>{let t=new Date(e),a=new Date,s=Math.abs(a.getTime()-t.getTime()),i=Math.ceil(s/864e5);return 1===i?"Today":2===i?"Yesterday":i<=7?"".concat(i-1," days ago"):t.toLocaleDateString()},handleSignOut=async()=>{await t()},Y=F.map(e=>({...e,count:T.filter(t=>t.folder===e.id||t.folder===e.name).length})),B=U.map(e=>({...e,count:T.filter(t=>t.tags.includes(e.name)).length}));return(0,s.jsxs)("div",{className:"app-container",children:[(0,s.jsxs)("div",{className:"sidebar",children:[(0,s.jsx)("div",{className:"sidebar-header",children:(0,s.jsxs)("button",{className:"new-note-btn",onClick:handleNewNote,children:[(0,s.jsx)("i",{className:"ri-add-line minimalist-icon",children:"+"}),"New Note"]})}),(0,s.jsxs)("div",{className:"section-header",children:[(0,s.jsx)("div",{className:"section-title",children:"Folders"}),(0,s.jsx)("button",{className:"add-btn",onClick:()=>w(!0),"aria-label":"Add new folder",children:(0,s.jsx)("i",{className:"ri-add-line minimalist-icon",children:"+"})})]}),(0,s.jsxs)("div",{className:"sidebar-item",onClick:()=>u("all"),children:[(0,s.jsxs)("div",{className:"sidebar-item-left",children:[(0,s.jsx)("i",{className:"ri-file-text-line minimalist-icon",children:"\uD83D\uDDD2️"}),(0,s.jsx)("span",{children:"All Notes"})]}),(0,s.jsx)("div",{className:"badge",children:T.length})]}),Y.map(e=>(0,s.jsxs)("div",{className:"sidebar-item ".concat(h===e.id?"selected":""),onClick:()=>u(e.id),children:[(0,s.jsxs)("div",{className:"sidebar-item-left",children:[(0,s.jsx)("i",{className:"ri-folder-line minimalist-icon",children:"▣"}),(0,s.jsx)("span",{children:e.name})]}),(0,s.jsxs)("div",{className:"sidebar-item-right",children:[(0,s.jsx)("div",{className:"badge",children:e.count}),(0,s.jsx)("button",{className:"delete-btn",onClick:t=>{t.stopPropagation(),handleDeleteFolder(e.id)},"aria-label":"Delete folder ".concat(e.name),children:(0,s.jsx)("i",{className:"ri-delete-bin-line minimalist-icon",children:"✕"})})]})]},e.id)),(0,s.jsxs)("div",{className:"section-header",children:[(0,s.jsx)("div",{className:"section-title",children:"Tags"}),(0,s.jsx)("button",{className:"add-btn",onClick:()=>S(!0),"aria-label":"Add new tag",children:(0,s.jsx)("i",{className:"ri-add-line minimalist-icon",children:"+"})})]}),B.map(e=>(0,s.jsxs)("div",{className:"sidebar-item ".concat(N.includes(e.id)?"selected":""),onClick:()=>handleTagSelect(e.id),children:[(0,s.jsxs)("div",{className:"sidebar-item-left",children:[(0,s.jsx)("i",{className:"ri-price-tag-3-line minimalist-icon",children:"#"}),(0,s.jsxs)("span",{children:["#",e.name]})]}),(0,s.jsxs)("div",{className:"sidebar-item-right",children:[(0,s.jsx)("div",{className:"badge",children:e.count}),(0,s.jsx)("button",{className:"delete-btn",onClick:t=>{t.stopPropagation(),handleDeleteTag(e.id)},"aria-label":"Delete tag ".concat(e.name),children:(0,s.jsx)("i",{className:"ri-delete-bin-line minimalist-icon",children:"✕"})})]})]},e.id))]}),(0,s.jsxs)("div",{className:"main-content-area",children:[(0,s.jsxs)("div",{className:"top-bar",children:[(0,s.jsx)("div",{className:"app-title",children:"NotesApp"}),(0,s.jsxs)("div",{className:"top-bar-actions",children:[(0,s.jsx)("div",{className:"user-info",children:(0,s.jsx)("span",{className:"user-email",children:null==e?void 0:e.email})}),(0,s.jsx)("button",{className:"theme-toggle",onClick:()=>{let e=!r;c(e),e?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("notesapp_theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("notesapp_theme","light"))},"aria-label":"Toggle theme",children:(0,s.jsx)("i",{className:r?"ri-sun-line":"ri-moon-line"})}),(0,s.jsx)("button",{className:"calendar-btn",onClick:()=>{a.push("/calendar")},"aria-label":"Go to calendar",style:{marginLeft:"8px"},children:(0,s.jsx)("i",{className:"ri-calendar-line"})}),(0,s.jsx)("button",{className:"signout-btn",onClick:handleSignOut,"aria-label":"Sign out",children:(0,s.jsx)("i",{className:"ri-logout-box-line"})})]})]}),(0,s.jsxs)("div",{className:"main-content-columns",style:{display:"flex",flexDirection:"row",height:"100%"},children:[(0,s.jsxs)("div",{className:"middle-column",children:[(0,s.jsx)("div",{className:"search-container",children:(0,s.jsx)("input",{type:"text",className:"search-input",placeholder:"Search notes...",value:o,onChange:e=>m(e.target.value)})}),(0,s.jsxs)("div",{className:"notes-container",children:[H.length>0&&(0,s.jsxs)("div",{className:"notes-section",children:[(0,s.jsx)("div",{className:"notes-section-title",children:"Pinned Notes"}),H.map(e=>(0,s.jsxs)("div",{className:"note-card ".concat(g===e.id?"selected":""),onClick:()=>handleNoteSelect(e.id),children:[(0,s.jsxs)("div",{className:"note-header",children:[(0,s.jsx)("div",{className:"note-title",children:e.title||"Untitled"}),(0,s.jsx)("div",{className:"note-date",children:formatDate(e.updated_at)})]}),(0,s.jsx)("div",{className:"note-preview",children:e.content}),e.tags.length>0&&(0,s.jsx)("div",{className:"note-tags",children:e.tags.map(e=>(0,s.jsxs)("span",{className:"tag-pill",children:["#",e]},e))}),(0,s.jsxs)("div",{className:"note-actions",children:[(0,s.jsx)("button",{className:"action-btn",onClick:t=>{t.stopPropagation(),handleTogglePin(e.id)},"aria-label":e.is_pinned?"Unpin note":"Pin note",children:(0,s.jsx)("i",{className:"ri-pushpin-fill minimalist-icon",children:"\uD83D\uDCCC"})}),(0,s.jsx)("button",{className:"action-btn",onClick:t=>{t.stopPropagation(),handleDeleteNote(e.id)},"aria-label":"Delete note",children:(0,s.jsx)("i",{className:"ri-delete-bin-line minimalist-icon",children:"✕"})})]})]},e.id))]}),(0,s.jsxs)("div",{className:"notes-section",children:[(0,s.jsx)("div",{className:"notes-section-title",children:"All Notes"}),R.map(e=>(0,s.jsxs)("div",{className:"note-card ".concat(g===e.id?"selected":""),onClick:()=>handleNoteSelect(e.id),children:[(0,s.jsxs)("div",{className:"note-header",children:[(0,s.jsx)("div",{className:"note-title",children:e.title||"Untitled"}),(0,s.jsx)("div",{className:"note-date",children:formatDate(e.updated_at)})]}),(0,s.jsx)("div",{className:"note-preview",children:e.content}),e.tags.length>0&&(0,s.jsx)("div",{className:"note-tags",children:e.tags.map(e=>{let t=U.find(t=>t.id===e);return t?(0,s.jsxs)("span",{className:"tag-pill",children:["#",t.name]},e):null})}),(0,s.jsxs)("div",{className:"note-actions",children:[(0,s.jsx)("button",{className:"action-btn",onClick:t=>{t.stopPropagation(),handleTogglePin(e.id)},"aria-label":e.is_pinned?"Unpin note":"Pin note",children:(0,s.jsx)("i",{className:"ri-pushpin-fill minimalist-icon",children:"\uD83D\uDCCC"})}),(0,s.jsx)("button",{className:"action-btn",onClick:t=>{t.stopPropagation(),handleDeleteNote(e.id)},"aria-label":"Delete note",children:(0,s.jsx)("i",{className:"ri-delete-bin-line minimalist-icon",children:"✕"})})]})]},e.id))]})]})]}),(0,s.jsx)("div",{className:"right-pane",children:f?(0,s.jsxs)("div",{className:"note-editor",children:[(0,s.jsxs)("div",{className:"editor-header",children:[(0,s.jsx)("div",{className:"editor-title",children:"Note Editor"}),(0,s.jsx)("div",{className:"editor-actions",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"editor-btn",onClick:()=>{v(!1);let e=T.find(e=>e.id===(null==f?void 0:f.id));e&&b(e)},children:"Cancel"}),(0,s.jsx)("button",{className:"editor-btn primary",onClick:handleSaveNote,children:"Save"})]}):(0,s.jsx)("button",{className:"editor-btn primary",onClick:()=>v(!0),children:"Edit"})})]}),(0,s.jsx)("div",{className:"editor-content",style:{maxHeight:"60vh",overflowY:"auto"},children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",className:"editor-input",value:f.title,onChange:e=>b({...f,title:e.target.value}),placeholder:"Note title..."}),(0,s.jsx)("textarea",{className:"editor-textarea",value:f.content,onChange:e=>b({...f,content:e.target.value}),placeholder:"Start writing your note...",style:{minHeight:"200px",maxHeight:"40vh",overflowY:"auto"}}),(0,s.jsxs)("div",{className:"editor-tags",children:[(0,s.jsx)("div",{className:"editor-tags-label",children:"Tags:"}),(0,s.jsxs)("div",{className:"editor-tags-list",children:[0===U.length&&(0,s.jsx)("span",{className:"editor-tags-empty",children:"No tags created yet."}),U.map(e=>(0,s.jsxs)("button",{type:"button",className:"tag-pill editor-tag-btn".concat(f.tags.includes(e.id)?" selected":""),onClick:()=>{f.tags.includes(e.id)?b({...f,tags:f.tags.filter(t=>t!==e.id)}):b({...f,tags:[...f.tags,e.id]})},children:["#",e.name]},e.id))]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"editor-input",children:f.title||"Untitled"}),(0,s.jsx)("div",{className:"editor-textarea",style:{whiteSpace:"pre-wrap",maxHeight:"40vh",overflowY:"auto"},children:f.content||"No content"}),f.tags.length>0&&(0,s.jsx)("div",{className:"note-tags",style:{marginTop:"16px"},children:f.tags.map(e=>{let t=U.find(t=>t.id===e);return t?(0,s.jsxs)("span",{className:"tag-pill",children:["#",t.name]},t.id):null})})]})})]}):(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("div",{className:"empty-icon",children:"\uD83D\uDCDD"}),(0,s.jsx)("div",{className:"empty-title",children:"Note Editor"}),(0,s.jsx)("div",{className:"empty-subtitle",children:"Note editing functionality will be implemented here"})]})})]})]}),C&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>w(!1),children:(0,s.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h3",{children:"Create New Folder"}),(0,s.jsx)("button",{className:"modal-close",onClick:()=>w(!1),"aria-label":"Close modal",children:(0,s.jsx)("i",{className:"ri-close-line"})})]}),(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsx)("input",{type:"text",className:"modal-input",placeholder:"Enter folder name...",value:_,onChange:e=>k(e.target.value),onKeyPress:e=>"Enter"===e.key&&handleCreateFolder(),autoFocus:!0}),P&&(0,s.jsx)("div",{className:"modal-error",children:P})]}),(0,s.jsxs)("div",{className:"modal-actions",children:[(0,s.jsx)("button",{className:"modal-btn",onClick:()=>w(!1),children:"Cancel"}),(0,s.jsx)("button",{className:"modal-btn primary",onClick:handleCreateFolder,children:"Create"})]})]})}),y&&(0,s.jsx)("div",{className:"modal-overlay",onClick:()=>S(!1),children:(0,s.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h3",{children:"Create New Tag"}),(0,s.jsx)("button",{className:"modal-close",onClick:()=>S(!1),"aria-label":"Close modal",children:(0,s.jsx)("i",{className:"ri-close-line"})})]}),(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsx)("input",{type:"text",className:"modal-input",placeholder:"Enter tag name...",value:D,onChange:e=>A(e.target.value),onKeyPress:e=>"Enter"===e.key&&handleCreateTag(),autoFocus:!0}),P&&(0,s.jsx)("div",{className:"modal-error",children:P})]}),(0,s.jsxs)("div",{className:"modal-actions",children:[(0,s.jsx)("button",{className:"modal-btn",onClick:()=>S(!1),children:"Cancel"}),(0,s.jsx)("button",{className:"modal-btn primary",onClick:handleCreateTag,children:"Create"})]})]})})]})}function Home(){return(0,s.jsx)(ProtectedRoute,{children:(0,s.jsx)(NotesApp,{})})}},7318:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var s=a(7437),i=a(2265),l=a(2445);let n=(0,i.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[a,d]=(0,i.useState)(null),[r,c]=(0,i.useState)(null),[o,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{l.O.auth.getSession().then(e=>{var t;let{data:{session:a}}=e;c(a),d(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null),m(!1)});let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,t)=>{var a;c(t),d(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),m(!1)});return()=>e.unsubscribe()},[]);let signOut=async()=>{await l.O.auth.signOut()};return(0,s.jsx)(n.Provider,{value:{user:a,session:r,loading:o,signOut},children:t})}function useAuth(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2445:function(e,t,a){"use strict";a.d(t,{O:function(){return d}});var s=a(1492),i=a(2601);let l=i.env.NEXT_PUBLIC_SUPABASE_URL,n=i.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,d=(0,s.eI)(l,n)},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[889,971,472,744],function(){return e(e.s=5479)}),_N_E=e.O()}]);