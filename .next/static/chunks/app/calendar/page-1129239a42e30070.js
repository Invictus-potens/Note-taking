(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{2512:function(e,t,n){Promise.resolve().then(n.bind(n,3417))},3417:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return CalendarRoute}});var r=n(7437),a=n(2265),l=n(1580),s=n(9571),i=n(4222),d=n(5283),u=n(5418),o=n(2867),c=n(4903),h=n(1886),x=n(9147),m=n(2445),v=n(7318);function CalendarPage(){let[e,t]=(0,a.useState)(new Date),[n,g]=(0,a.useState)([]),[f,b]=(0,a.useState)(null),[p,y]=(0,a.useState)(!1),[N,j]=(0,a.useState)({title:"",time:"",location:""}),{user:C}=(0,v.useAuth)(),fetchEvents=async()=>{let t=(0,l.ZP)((0,s.Z)(e),"yyyy-MM-dd"),n=(0,l.ZP)((0,i.Z)(e),"yyyy-MM-dd"),{data:r,error:a}=await m.O.from("calendar_events").select("*").gte("date",t).lte("date",n).eq("user_id",null==C?void 0:C.id);a?console.error(a):g(r||[])};(0,a.useEffect)(()=>{C&&fetchEvents()},[e,C]);let createEvent=async()=>{if(!f||!N.title||!N.time||!(null==C?void 0:C.id))return;let{error:e}=await m.O.from("calendar_events").insert({title:N.title,date:(0,l.ZP)(f,"yyyy-MM-dd"),time:N.time,location:N.location,user_id:C.id});e?console.error("Create event error:",e):(y(!1),j({title:"",time:"",location:""}),fetchEvents())},E=(0,d.Z)((0,s.Z)(e),{weekStartsOn:0}),S=(0,u.Z)((0,i.Z)(e),{weekStartsOn:0}),P=[],A=E;for(;A<=S;)P.push(A),A=(0,o.Z)(A,1);return(0,r.jsxs)("div",{className:"min-h-screen bg-[#1E2230] text-white p-6",children:[(0,r.jsxs)("header",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Calend\xe1rio"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>t((0,o.Z)(e,-30)),className:"px-3 py-1 bg-[#2E3347] rounded",children:"Anterior"}),(0,r.jsx)("button",{onClick:()=>t((0,o.Z)(e,30)),className:"px-3 py-1 bg-[#2E3347] rounded",children:"Pr\xf3ximo"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-2 text-center mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>(0,r.jsx)("div",{className:"text-gray-400",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-2",children:P.map((t,a)=>{let s=n.filter(e=>e.date===(0,l.ZP)(t,"yyyy-MM-dd"));return(0,r.jsxs)("div",{onClick:()=>{b(t),y(!0)},className:"p-2 rounded cursor-pointer min-h-[80px] ".concat((0,c.Z)(t,e)?"bg-[#202434]":"bg-[#1A1D2D]"," ").concat((0,h.Z)(t)?"border border-[#4D7CFE]":""),children:[(0,r.jsx)("div",{className:"text-sm text-gray-300",children:(0,l.ZP)(t,"d")}),(0,r.jsx)("div",{className:"space-y-1 mt-1",children:s.map(e=>(0,r.jsx)("div",{className:"text-xs truncate bg-[#4D7CFE] rounded px-1",children:e.title},e.id))})]},a)})}),(0,r.jsx)(x.Vq,{open:p,onClose:()=>y(!1),className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)(x.Vq.Panel,{className:"bg-[#202434] p-6 rounded w-96",children:[(0,r.jsx)(x.Vq.Title,{className:"text-lg font-semibold mb-4",children:"Novo Evento"}),(0,r.jsx)("input",{type:"text",placeholder:"T\xedtulo",value:N.title,onChange:e=>j({...N,title:e.target.value}),className:"w-full p-2 mb-2 rounded bg-[#1E2230] border border-gray-600"}),(0,r.jsx)("input",{type:"time",value:N.time,onChange:e=>j({...N,time:e.target.value}),className:"w-full p-2 mb-2 rounded bg-[#1E2230] border border-gray-600"}),(0,r.jsx)("input",{type:"text",placeholder:"Local",value:N.location,onChange:e=>j({...N,location:e.target.value}),className:"w-full p-2 mb-4 rounded bg-[#1E2230] border border-gray-600"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>y(!1),className:"px-3 py-1 bg-gray-600 rounded",children:"Cancelar"}),(0,r.jsx)("button",{onClick:createEvent,className:"px-3 py-1 bg-[#4D7CFE] rounded",children:"Salvar"})]})]})})]})}function CalendarRoute(){return(0,r.jsxs)("div",{style:{padding:32},children:[(0,r.jsx)("h1",{children:"Calendar"}),(0,r.jsx)(CalendarPage,{})]})}},7318:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=n(7437),a=n(2265),l=n(2445);let s=(0,a.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[n,i]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{l.O.auth.getSession().then(e=>{var t;let{data:{session:n}}=e;u(n),i(null!==(t=null==n?void 0:n.user)&&void 0!==t?t:null),c(!1)});let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,t)=>{var n;u(t),i(null!==(n=null==t?void 0:t.user)&&void 0!==n?n:null),c(!1)});return()=>e.unsubscribe()},[]);let signOut=async()=>{await l.O.auth.signOut()};return(0,r.jsx)(s.Provider,{value:{user:n,session:d,loading:o,signOut},children:t})}function useAuth(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2445:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(1492),a=n(2601);let l=a.env.NEXT_PUBLIC_SUPABASE_URL,s=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,i=(0,r.eI)(l,s)}},function(e){e.O(0,[889,4,971,472,744],function(){return e(e.s=2512)}),_N_E=e.O()}]);